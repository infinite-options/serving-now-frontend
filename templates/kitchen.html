{% extends "main.html" %} {% block content%}

<script src="{{ url_for('.static', filename='script.js') }}">
</script>
<!-- References scripts for web interaction -->
<script src="{{ url_for('.static', filename='addMeal.js') }}"></script>
<script src="{{ url_for('.static', filename='editMeal.js') }}"></script>
<script src="{{ url_for('.static', filename='updateMeal.js') }}"></script>
<script src="{{ url_for('.static', filename='deleteMeal.js') }}"></script>
<script src="{{ url_for('.static', filename='favMeal.js') }}"></script>

<link href="{{ url_for('.static', filename='style.css') }}" rel="stylesheet" />
<!-- References style sheet -->

<!DOCTYPE html>

<head>
    <title>
        Kitchen Home Page
    </title>
</head>

<script>
    $(document).ready(function() {
        $('.special.cards .image').dimmer({
            on: 'hover'
        });
    })
</script>

<style>
    .serving-now-logo {
        width: 130px;
        height: 130px;
    }

    .grid-container {
        display: grid;
        grid-template-areas: 'logo right-content''logo addmealbtn ''current-meal current-meal''currentmeal-card currentmeal-card''pastmeal pastmeal''pastmeal-card pastmeal-card';
        grid-template-columns: repeat(auto-fit);
        padding: 10px;
        grid-row-gap: 5px;
    }

    #logo {
        display: grid;
        grid-template-columns: auto 1fr;
        grid-area: logo;
        grid-column-gap: 10px;
        padding: 40px;
    }

    #kitchen-name {
        grid-area: kitchen-name;
    }

    #right-content {
        margin-top: 40px;
        display: grid;
        grid-row-gap: 5px;
        grid-auto-rows: minmax(50px, auto);
        margin-right: none;
        place-content: end;
        padding-right: 40px;
    }

    #currentmeal {
        grid-area: current-meal;
        margin-left: 40px;
        margin-top: 10px;
    }

    #currentmeal-card {
        display: grid;
        grid-area: currentmeal-card;
        grid-auto-rows: minmax(100px, auto);
        grid-column-gap: none;
        margin-top: 10px;
        margin-left: 40px;
        margin-right: none;
    }

    #pastmeal {
        grid-area: pastmeal;
        margin: 40px;
    }

    #pastmeal-card {
        grid-area: pastmeal-card;
        display: grid;
        padding: 15px;
        margin: 40px;
        background-color: #cccccc;
        grid-auto-rows: minmax(100px, auto);
    }

    .add-meal-btn,
    .kitchen-username-btn {
        background: #a0050f;
        border-radius: 20px;
        border: 2px solid #ECEAEA;
        color: #ECEAEA;
    }

    .add-meal-btn-div {
        margin-left: 42%;
    }

    .kitchen-username {
        cursor: text !important;
        width: 150px;
        height: 40px;
    }
</style>

<body style="background-color:#ECEAEA">
    <div class="grid-container">
        <div id="logo">
            <div> <img src="{{ url_for('.static', filename='ServingNowLogo.png') }}" class="serving-now-logo"></div>
            <div>
                <strong><i><h3>{{ name }}</h3></i></strong>
                <div><button type="text" class="button btn-primary kitchen-username kitchen-username-btn mt-2 mb-2"><i>Saurabh Mane</i></button></div>
                <!-- <div class="add-meal-btn-div"> -->
                <div class="mb-2"><button type="button" class="btn btn-primary add-meal-btn" data-toggle="modal" data-target="#addMeal">
                    <i>Add Meal</i>
                </button>
                </div>
            </div>
        </div>
        <div id="currentmeal">
            <strong><i>Current Meal:</i></strong>
        </div>
        <div id="currentmeal-card">
            <div class="row">
                {% for meal in todaysMeals %}
                <!-- % beginning of JS logic -->
                <div class="col-md-3 parent-class" style="padding-bottom: 2rem;" data-meal_id="{{meal.meal_id.S}}">
                    <div class="ui special cards">
                        <div class="card">
                            <div class="blurring dimmable image">
                                <div class="ui dimmer">
                                    <div class="content">
                                        <div class="row">
                                            <div class="col">
                                                <input type="image" class="ui inverted" width="40" height="40" src="{{ url_for('.static', filename='EditIcon.png') }}" data-meal_id="{{meal.meal_id.S}}" data-toggle="modal" id="edit-meal-btn" data-meal_name="{{meal.meal_name.S}}" data-meal_photo="{{meal.photo.S}}"
                                                    data-meal_price="{{meal.price.S}}" data-meal_description="{{meal.description.S}}" data-target="#editMeal">
                                            </div>
                                            <div class="col">
                                                <input onclick="deleteMeal('{{meal.meal_id.S}}');" type="image" class="ui inverted" width="40" height="40" src="{{ url_for('.static', filename='TrashIcon.png') }}" id="delete-meal-btn">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <img src={{meal.photo.S}} class="card-img-top" style="max-width:290px; height:174px">
                            </div>
                            <div class="content">
                                <a class="header"><i>{{meal.meal_name.S}}</i></a>
                                <div class="meta">
                                    <span class="date"><i>{{meal.description.S}}</i></span>
                                </div>
                            </div>
                            <div class="extra content">
                                <div class="row">
                                    <div class="col">
                                        <i class="dollar sign icon"></i>{{meal.price.S}}
                                    </div>
                                    <div class="col" style="margin-left:25%">
                                        <a onclick="favMeal('{{meal.meal_id.S}}')">
                                            {% if meal.favorite.BOOL %}
                                                <i class="star outline icon"></i> Fav
                                            {% else %}
                                                <i class="star icon"></i> Fav
                                            {% endif %}
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        <div id="pastmeal">
            <strong><i>Past Meal: </i></strong>
        </div>
        <div id="pastmeal-card">
            Past meal card goes here
        </div>
        <!-- </div> -->

        <div class="modal fade" id="addMeal" tabindex="-1" role="dialog" aria-labelledby="addMealLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content" id="form-bg">
                    <form class="add_meal_form">
                        <div class="modal-header">
                            <h5 class="modal-title" id="addMealLabel">Post Meal</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                        </div>
                        <div class="modal-body">
                            <div>
                                <div class="row">
                                    <div class="col-2"></div>
                                    <div class="col-8">
                                        <div class="row">
                                            <div class="col">
                                                <br>
                                                <img class="img-bg" src="" width="299" height="194">
                                            </div>
                                        </div>
                                        <div class="row add-meal-img-btn">

                                            <div class="file btn btn-lg btn-primary">
                                                Add photo
                                                <input type="file" name="photo" id="add_meal_image" onchange="previewFile()" /><br>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col name-of-meal">
                                    <i><input type="text" class="form-control form-control-class" id="add_meal_mealname"
                                    placeholder="Name of the meal"></i>
                                </div>
                            </div>
                            <div class="pl-5">
                              <div class="form-row">
                                  <table id="option-setup">
                                      <tr>
                                          <td>
                                            <span class="left-content"><strong><i>Items in this meal</i></strong></span>
                                          </td>
                                          <td>
                                              <span>
                                          <select id="option-items" style="border-radius: 15px">
                                              <option value="1">1</option>
                                              <option value="2">2</option>
                                              <option value="3">3</option>
                                              <option value="4">4</option>
                                              <option value="5">5</option>
                                          </select>
                                      </span>
                                          </td>
                                      </tr>
                                      <tr>
                                          <td>
                                              <span><strong><i>Item name</i></strong></span>
                                          </td>
                                          <td>
                                              <span><strong><i>Item Quantity</i></strong></span>
                                          </td>
                                      </tr>
                                      <br>
                                      <tr id="option-item1">
                                          <td>
                                              <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="add_meal_option1_name" maxlength="15">
                                          </td>
                                          <td>
                                              <span>
                                          <select id="add_meal_option1_qty">
                                              <option value="1">1</option>
                                              <option value="2">2</option>
                                              <option value="3">3</option>
                                              <option value="4">4</option>
                                              <option value="5">5</option>
                                              <option value="6">6</option>
                                              <option value="7">7</option>
                                              <option value="8">8</option>
                                              <option value="9">9</option>
                                              <option value="10">10</option>
                                          </select>
                                      </span>
                                          </td>
                                      </tr>
                                      <tr id="option-item2">

                                          <td>
                                              <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="add_meal_option2_name" maxlength="15">
                                          </td>
                                          <td>
                                              <span style="padding-left:30%">
                                          <select id="add_meal_option2_qty">
                                              <option value="1">1</option>
                                              <option value="2">2</option>
                                              <option value="3">3</option>
                                              <option value="4">4</option>
                                              <option value="5">5</option>
                                              <option value="6">6</option>
                                              <option value="7">7</option>
                                              <option value="8">8</option>
                                              <option value="9">9</option>
                                              <option value="10">10</option>
                                          </select>
                                      </span>
                                          </td>
                                      </tr>
                                      <tr id="option-item3">

                                          <td>
                                              <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="add_meal_option3_name" maxlength="15">
                                          </td>
                                          <td>
                                              <span style="padding-left:30%">
                                          <select id="add_meal_option3_qty">
                                              <option value="1">1</option>
                                              <option value="2">2</option>
                                              <option value="3">3</option>
                                              <option value="4">4</option>
                                              <option value="5">5</option>
                                              <option value="6">6</option>
                                              <option value="7">7</option>
                                              <option value="8">8</option>
                                              <option value="9">9</option>
                                              <option value="10">10</option>
                                          </select>
                                      </span>
                                          </td>
                                      </tr>
                                      <tr id="option-item4">

                                          <td>
                                              <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="add_meal_option4_name" maxlength="15">
                                          </td>
                                          <td>
                                              <span style="padding-left:30%">
                                          <select id="add_meal_option4_qty">
                                              <option value="1">1</option>
                                              <option value="2">2</option>
                                              <option value="3">3</option>
                                              <option value="4">4</option>
                                              <option value="5">5</option>
                                              <option value="6">6</option>
                                              <option value="7">7</option>
                                              <option value="8">8</option>
                                              <option value="9">9</option>
                                              <option value="10">10</option>
                                          </select>
                                      </span>
                                          </td>
                                      </tr>
                                      <tr id="option-item5">

                                          <td>
                                              <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="add_meal_option5_name" maxlength="15">
                                          </td>
                                          <td>
                                              <span style="padding-left:30%">
                                          <select id="add_meal_option5_qty">
                                              <option value="1">1</option>
                                              <option value="2">2</option>
                                              <option value="3">3</option>
                                              <option value="4">4</option>
                                              <option value="5">5</option>
                                              <option value="6">6</option>
                                              <option value="7">7</option>
                                              <option value="8">8</option>
                                              <option value="9">9</option>
                                              <option value="10">10</option>
                                          </select>
                                      </span>
                                          </td>
                                      </tr>
                                  </table>
                              </div>
                              <div class="form-row">
                                  <div class="left-content" id="meal-id">
                                      <strong><i>Meal Price</i></strong>
                                  </div>
                                  <div class="right-content">
                                      <input type="number" name="price" class="right-content form-control form-control-class" id="add_meal_price">
                                  </div>
                              </div>
                            </div>

                            <div class="modal-footer">
                                <button value="submit" onclick="postMeal();" class="btn btn-primary post-meal-btn">Save</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="modal fade" id="editMeal" tabindex="-1" role="dialog" aria-labelledby="editMealLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content" id="form-bg">
                    <form class="edit_meal_form">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editMealLabel">Edit Meal</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                        </div>
                        <div class="modal-body">
                            <div>
                                <div class="form-row">
                                    <div class="edit-img-meal">
                                        <img class="img-fluid img-thumbnail rounded" id="edit_img_preview" />
                                        <div class="file btn btn-lg btn-primary">
                                            Change Meal Photo
                                            <input type="file" name="photo" id="edit_meal_image" onclick="uploadButton(this)" onchange="uploadNewPhoto(this.files)" accept="image/png, image/jpeg" />
                                        </div>
                                    </div>
                                </div>

                                <!-- use this to retrieve the meal id from edit meal -->
                                <div class="row">
                                   <div class="col id-of-meal">
                                     <i><p hidden
                                           type="text"
                                           class="form-control form-control-class"
                                           id="edit_meal_mealid">
                                     </i>
                                   </div>
                                 </div>


                                <div class="row">
                                    <div class="col name-of-meal">
                                        <i><input type="text" class="form-control form-control-class" id="edit_meal_mealname"
                                        placeholder="Name of the meal"></i>
                                    </div>
                                </div>
                                <!-- <div class="form-row">
                                <input type="text" name="name" placeholder="Meal Name" id="edit_meal_mealname" />
                            </div> -->

                                <div class="form-row">
                                    <table id="edit-option-setup">
                                        <tr>
                                            <td>
                                                <span><strong><i>Items in this meal</i></strong></span>
                                            </td>
                                            <td>
                                                <select id="edit-option-items">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                            </td>
                                        </tr>
                                        <tr>

                                            <td>
                                                <span style="padding-left: 30%"><strong><i>Item name</i></strong></span>
                                            </td>
                                            <td>
                                                <span><strong><i>Item Quantity</i></strong></span>
                                            </td>
                                        </tr>
                                        <tr id="edit-option-item1">

                                            <td>
                                                <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="edit_meal_option1_name" maxlength="15">
                                            </td>
                                            <td>
                                                <span style="padding-left:30%">
                                            <select id="edit_meal_option1_qty">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option>
                                                <option value="8">8</option>
                                                <option value="9">9</option>
                                                <option value="10">10</option>
                                            </select>
                                        </span>
                                            </td>
                                        </tr>
                                        <tr id="edit-option-item2">

                                            <td>
                                                <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="edit_meal_option2_name" maxlength="15">
                                            </td>
                                            <td>
                                                <span style="padding-left:30%">
                                            <select id="edit_meal_option2_qty">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option>
                                                <option value="8">8</option>
                                                <option value="9">9</option>
                                                <option value="10">10</option>
                                            </select>
                                        </span>
                                            </td>
                                        </tr>
                                        <tr id="edit-option-item3">

                                            <td>
                                                <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="edit_meal_option3_name" maxlength="15">
                                            </td>
                                            <td>
                                                <span style="padding-left:30%">
                                            <select id="edit_meal_option3_qty">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option>
                                                <option value="8">8</option>
                                                <option value="9">9</option>
                                                <option value="10">10</option>
                                            </select>
                                        </span>
                                            </td>
                                        </tr>
                                        <tr id="edit-option-item4">

                                            <td>
                                                <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="edit_meal_option4_name" maxlength="15">
                                            </td>
                                            <td>
                                                <span style="padding-left:30%">
                                            <select id="edit_meal_option4_qty">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option>
                                                <option value="8">8</option>
                                                <option value="9">9</option>
                                                <option value="10">10</option>
                                            </select>
                                        </span>
                                            </td>
                                        </tr>
                                        <tr id="edit-option-item5">

                                            <td>
                                                <input type="text" class="form-control form-control-class" placeholder="(15 characters limit)" id="edit_meal_option5_name" maxlength="15">
                                            </td>
                                            <td>
                                                <span style="padding-left:30%">
                                            <select id="edit_meal_option5_qty">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option>
                                                <option value="8">8</option>
                                                <option value="9">9</option>
                                                <option value="10">10</option>
                                            </select>
                                        </span>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="form-row">
                                    <div class="col-md" id="meal-id">
                                        <strong><i>Meal Price</i></strong>
                                    </div>
                                    <div class="col-md">
                                        <input type="number" name="price" class="form-control form-control-class" id="edit_meal_price">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> -->
                            <button value="submit" onclick="updateMeal();" class="btn btn-primary post-meal-btn">Update
                        Meal</button>
                            <!-- update button, calls update meal javascript -->
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>
{% endblock %}
